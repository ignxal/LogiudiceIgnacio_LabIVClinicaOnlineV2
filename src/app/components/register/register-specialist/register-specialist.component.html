<div class="container">
  <div class="overlay-panel">
    <h2>{{ title }}</h2>
    <form
      [formGroup]="registroForm"
      (ngSubmit)="submitForm()"
      class="needs-validation col-12"
      novalidate
    >
      <div class="row">
        <div class="mb-3 col-6">
          <label for="name" class="form-label">Nombre:</label>
          <input
            type="text"
            id="name"
            formControlName="name"
            class="form-control"
            required
          />
          <small class="text-danger" *ngIf="name?.errors && name?.touched"
            >Por favor, ingrese nombre.</small
          >
        </div>

        <div class="mb-3 col-6">
          <label for="lastName" class="form-label">Apellido:</label>
          <input
            type="text"
            id="lastName"
            formControlName="lastName"
            class="form-control"
            required
          />
          <small
            class="text-danger"
            *ngIf="lastName?.errors && lastName?.touched"
            >Por favor, ingrese apellido.</small
          >
        </div>
      </div>
      <div class="row">
        <div class="mb-3 col-6">
          <label for="age" class="form-label">Edad:</label>
          <input
            type="number"
            id="age"
            formControlName="age"
            class="form-control"
            required
          />
          <small class="text-danger" *ngIf="age?.errors && age?.touched"
            >Por favor, ingrese edad.</small
          >
        </div>
        <div class="mb-3 col-6">
          <label for="dni" class="form-label">DNI:</label>
          <input
            type="text"
            id="dni"
            formControlName="dni"
            class="form-control"
            required
          />
          <small class="text-danger" *ngIf="dni?.errors && dni?.touched"
            >Por favor, ingrese dni valido.</small
          >
        </div>
      </div>
      <div class="row">
        <div class="mb-3 col-6">
          <label for="specialty" class="form-label">Especialidad:</label>
          <div class="d-flex">
            <mat-select
              multiple
              formControlName="specialty"
              class="input-group form-select"
            >
              <mat-option *ngFor="let x of specialties" [value]="x">{{
                x
              }}</mat-option>
            </mat-select>
            <button
              mat-flat-button
              color="accent"
              class="addButton"
              (click)="addEspecialidad()"
            >
              <mat-icon>+</mat-icon>
            </button>
          </div>
          <small
            class="text-danger"
            *ngIf="specialty?.errors && specialty?.touched"
          >
            Por favor, ingrese una especialidad.
          </small>
        </div>

        <div class="mb-3 col-6">
          <label for="email" class="form-label">Correo electrónico:</label>
          <input
            type="email"
            id="email"
            formControlName="email"
            class="form-control"
            required
          />
          <ng-container *ngIf="email?.hasError('email')">
            <small class="text-danger">Formato inválido</small>
          </ng-container>
          <small
            class="text-danger"
            *ngIf="email?.errors && email?.touched && !email?.hasError('email')"
            >Por favor, ingrese un correo electrónico.</small
          >
        </div>
      </div>
      <div class="row">
        <div class="mb-3 col-6">
          <label for="password" class="form-label">Contraseña:</label>
          <input
            type="password"
            id="password"
            formControlName="password"
            class="form-control"
            required
          />
          <ng-container *ngIf="password?.hasError('minlength')">
            <small class="text-danger">
              La clave debe tener mínimo
              {{ password?.getError("minlength").requiredLength }} caracteres
            </small>
          </ng-container>
        </div>
        <div class="mb-3 col-6">
          <label for="password2" class="form-label">Repetir Contraseña:</label>
          <input
            type="password"
            id="password2"
            formControlName="password2"
            class="form-control"
            required
          />
          <small class="text-danger">
            {{ password2?.getError("noCoincide") }}
          </small>
        </div>
      </div>
      <div class="row form-group">
        <div class="mb-3 col-12">
          <label for="perfil" class="form-label">Imagen de perfil:</label>
          <input
            type="file"
            id="perfil"
            accept="image/jpg, image/jpeg, image/png"
            class="form-control"
            (change)="handleFileInput($event, 'perfil')"
            required
          />
          <small class="text-danger" *ngIf="perfil?.errors && perfil?.touched"
            >Por favor, ingrese foto.</small
          >
        </div>
      </div>

      <app-captcha (captchaResult)="captchaResult($event)"></app-captcha>

      <div class="d-flex align-self-center" style="justify-content: center">
        <button type="submit" class="btn btn-primary col-4">Registrar</button>
      </div>
    </form>
  </div>
</div>
